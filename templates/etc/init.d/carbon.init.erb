#!/bin/sh
# !!! generated by puppet !!!

### BEGIN INIT INFO
# chkconfig: 2345 99 80 
# Provides: carbon-<%= @carbontype %>-<%= @carbonname %> 
# Required-Start: $remote_fs $network $time 
# Required-Stop: $remote_fs $network 
# Default-Start: 2 3 4 5 
# Default-Stop: 0 1 6 
# Short-Description: Start/Stop carbon-<%= @carbontype %>-<%= @carbonname %> 
# Description: Enables Graphites carbon-<%= @carbontype %>-<%= @carbonname %> data collecting engine
### END INIT INFO

case "$1" in
	start)
		su -c 'python /opt/graphite/bin/carbon-<%= @carbontype %>.py --config=/opt/graphite/conf/carbon-<%= @carbontype %>_<%= @carbonname %>.conf --instance=<%= @carbonname %> start' <%= scope.lookupvar('graphite::gr_user') %>
		;;
	stop)
		su -c 'python /opt/graphite/bin/carbon-<%= @carbontype %>.py --config=/opt/graphite/conf/carbon-<%= @carbontype %>_<%= @carbonname %>.conf --instance=<%= @carbonname %> stop' <%= scope.lookupvar('graphite::gr_user') %>
		;;
	status)
		su -c 'python /opt/graphite/bin/carbon-<%= @carbontype %>.py --config=/opt/graphite/conf/carbon-<%= @carbontype %>_<%= @carbonname %>.conf --instance=<%= @carbonname %> status' <%= scope.lookupvar('graphite::gr_user') %>
		;;
	restart)
		$0 stop ; sleep 3 ; $0 start
		RC=$?
		exit $RC
		;;
	*)
		echo "Usage: $0 {start|stop|restart|status}"
		exit 1
		;;
esac 

exit
